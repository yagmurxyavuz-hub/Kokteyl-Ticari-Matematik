<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Şişe & Kokteyl Maliyet Hesap</title>

<style>
:root{--radius:14px}
body{font-family:system-ui;background:#f6f7fb;margin:0;display:flex;justify-content:center;align-items:center;min-height:100vh}
.card{background:#fff;width:min(600px,95%);padding:16px;border-radius:18px;box-shadow:0 10px 30px rgba(0,0,0,.08)}
label{font-size:12px;color:#555;margin-bottom:6px;display:block}
.input{border:1px solid #e3e6ee;border-radius:12px;padding:10px}
input{border:0;outline:0;width:100%;font-size:16px}
.grid{display:grid;gap:12px}
.result{margin-top:14px}
.tile{background:#0f172a;color:#fff;padding:12px;border-radius:12px;margin-bottom:8px}
.tile.light{background:#fff;color:#111;border:1px solid #e9edf6}
button{border:0;border-radius:12px;padding:12px;font-size:15px;cursor:pointer}
.primary{background:#4f46e5;color:#fff}

/* DROPDOWN */
.dropdown{position:relative}
.dropdown-list{
  position:absolute;
  top:100%;
  left:0;
  right:0;
  background:#fff;
  border:1px solid #e3e6ee;
  border-radius:12px;
  max-height:220px;
  overflow:auto;
  display:none;
  z-index:10
}
.dropdown-item{
  padding:10px;
  cursor:pointer
}
.dropdown-item:hover{
  background:#eef2ff
}
</style>
</head>

<body>
<main class="card">
<h2>Şişe & Kokteyl Maliyet</h2>

<div class="grid">

<!-- MODERN ÜRÜN SEÇ -->
<div>
<label>Ürün Seç</label>
<div class="dropdown">
  <div class="input">
    <input id="urunAra" placeholder="Ürün ara...">
  </div>
  <div id="urunListe" class="dropdown-list"></div>
</div>
</div>

<div>
<label>Şişe Fiyatı</label>
<div class="input"><input id="price" type="number"></div>
</div>

<div>
<label>Şişe CL</label>
<div class="input"><input id="cl" type="number"></div>
</div>

</div>

<section class="result">
<div class="tile"><div>Net Şişe Fiyatı</div><div id="netOut">—</div></div>
<div class="tile light"><div>₺ / CL</div><div id="perCL">—</div></div>
</section>

<button class="primary" onclick="calc()">Hesapla</button>

</main>

<script>
const urunAra = document.getElementById("urunAra");
const urunListe = document.getElementById("urunListe");
const priceEl = document.getElementById("price");
const clEl = document.getElementById("cl");

let urunler = [];

/* CSV OKU */
fetch("urunler.csv")
.then(r=>r.text())
.then(t=>{
  const rows=t.trim().split("\n").slice(1);
  urunler=rows.map(r=>{
    const [ad,fiyat,cl]=r.split(",");
    return {ad,fiyat:+fiyat,cl:+cl};
  });
  renderList(urunler);
});

/* LISTE YAZ */
function renderList(list){
  urunListe.innerHTML="";
  list.forEach(u=>{
    const div=document.createElement("div");
    div.className="dropdown-item";
    div.textContent=u.ad;
    div.onclick=()=>{
      urunAra.value=u.ad;
      priceEl.value=u.fiyat;
      clEl.value=u.cl;
      urunListe.style.display="none";
      calc();
    };
    urunListe.appendChild(div);
  });
}

/* ARA */
urunAra.addEventListener("input",()=>{
  const q=urunAra.value.toLowerCase();
  const f=urunler.filter(u=>u.ad.toLowerCase().includes(q));
  renderList(f);
  urunListe.style.display="block";
});

/* ODAK */
urunAra.addEventListener("focus",()=>urunListe.style.display="block");
document.addEventListener("click",e=>{
  if(!e.target.closest(".dropdown")) urunListe.style.display="none";
});

/* HESAP */
function calc(){
  const p=+priceEl.value;
  const cl=+clEl.value;
  document.getElementById("netOut").textContent=p?`₺ ${p}`:"—";
  document.getElementById("perCL").textContent=(p&&cl)?`₺ ${(p/cl).toFixed(2)}`:"—";
}
</script>
</body>
</html>
